<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Frontend Components-based Architecture : javascript, frontend, architecture" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Frontend Components-based Architecture</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/artyomtrityak/component-based-architecture">View on GitHub</a>

          <h1 id="project_title">Frontend Components-based Architecture</h1>
          <h2 id="project_tagline">javascript, frontend, architecture</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/artyomtrityak/component-based-architecture/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/artyomtrityak/component-based-architecture/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="intro" class="anchor" href="#intro"><span class="octicon octicon-link"></span></a>Intro</h1>

<p>This article is accumulation of my experience building frontend apps architectures. Concepts i am writing about are fine for small and big apps, mobile and web.
I assume that everyone knows BackboneJS basics or at least understands it as pseudocode.</p>

<h2>
<a name="problem" class="anchor" href="#problem"><span class="octicon octicon-link"></span></a>Problem</h2>

<p>When application starts growing it takes more and more time to add new features, catch bugs and make refactoring.</p>

<h2>
<a name="why-this-happens" class="anchor" href="#why-this-happens"><span class="octicon octicon-link"></span></a>Why this happens?</h2>

<h3>
<a name="cross-dependencies" class="anchor" href="#cross-dependencies"><span class="octicon octicon-link"></span></a>Cross dependencies</h3>

<p>It's common practice when you need something that does not exist in current file but exist somewhere else in your project, you are just importing staff you need and use it.</p>

<p>For example:</p>

<div class="highlight highlight-js"><pre><span class="c1">//header-view.js</span>

<span class="kd">var</span> <span class="nx">StatsView</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'views/stats'</span><span class="p">),</span>
    <span class="nx">StatsModel</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'models/stats'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">HeaderView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">statsModel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StatsModel</span><span class="p">(),</span>
        <span class="nx">statsView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StatsView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span> <span class="nx">statsModel</span><span class="p">});</span>
    <span class="nx">statsModel</span><span class="p">.</span><span class="nx">fetch</span><span class="p">({</span>
      <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">'.user'</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">statsView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>This is good and bad.</p>

<p>Good - it looks pretty easy - if we need show Stats view in some place we can just include it and use.
Bad - Header view should know about internal Stats view implementation. It should know that it requires Stats model and should fetch data before render.</p>

<p>And what happens if StatsView will be changed? If it will use for example Collection instead of Model? </p>

<p>This case we should make lookup if whole project to understand who is using our StatsView and modify each entry.</p>

<p>This moves us to second problem</p>

<h3>
<a name="big-scope" class="anchor" href="#big-scope"><span class="octicon octicon-link"></span></a>Big scope</h3>

<p>Developers should always keep in mind whole project because they should know what part of the project is using current file (view, model etc) they are working on.</p>

<p>This is fine for small projects but a problem for another. Sometimes we are working with thousands files on one project. And dependencies can be so complex for example this view extends that view which has another mixin we want to change...</p>

<p>Developers start feel fatigue very fast.
Each modification requires "compiling whole project in the head" to understand what can be broken and what can be affected by this change.</p>

<p>As result - they want start working on something new and small again.</p>

<h3>
<a name="dry-dont-repeat-yourself" class="anchor" href="#dry-dont-repeat-yourself"><span class="octicon octicon-link"></span></a>DRY (don't repeat yourself)</h3>

<p>I think everyone knows this principle. But do we really follow it if we still should write same code (create model, fetching, create view) again and again?</p>

<p>The main goal DRY is allow to create something that can be reusable but not cause Cross dependencies and Big scope issues.</p>

<h1>
<a name="component-based-architecture" class="anchor" href="#component-based-architecture"><span class="octicon octicon-link"></span></a>Component-based architecture</h1>

<p>This is not something new.
I have just collected practices which helped me solve problems together and use them in my projects. And it works (at least for me).</p>

<h2>
<a name="overview" class="anchor" href="#overview"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>The main goal is create reusable components which provides Public API and hides implementation inside.</p>

<p>For example:</p>

<div class="highlight highlight-js"><pre><span class="c1">// header-view.js</span>

<span class="kd">var</span> <span class="nx">StatsModule</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'modules/stats'</span><span class="p">),</span>
    <span class="nx">statusModuleIns</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StatsModule</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">HeaderView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">statusModuleIns</span><span class="p">.</span><span class="nx">showDetails</span><span class="p">({</span>
      <span class="nx">container</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">'.user'</span><span class="p">)</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>This case we follow DRY as much as possible - no code duplication. As bonus we received reusable Stats component which hides implementation and gives Public API - showDetails method.</p>

<p>What inside?
Anything you want.</p>

<p>Example 1:</p>

<div class="highlight highlight-js"><pre><span class="c1">// modules/stats/main.js</span>

<span class="nx">define</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">require</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">Model</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./model'</span><span class="p">),</span>
      <span class="nx">View</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./view'</span><span class="p">),</span>
      <span class="nx">Controller</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>

  <span class="nx">Controller</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">showDetails</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span> <span class="o">=</span> <span class="nx">container</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">||</span> <span class="k">new</span> <span class="nx">Model</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">isNew</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">fetch</span><span class="p">({</span><span class="nx">success</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_renderDetails</span><span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_renderDetails</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">Controller</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_renderDetails</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">detailsView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">View</span><span class="p">({</span>
      <span class="nx">model</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span>
      <span class="nx">container</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">container</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">Controller</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>Or even Example 2:</p>

<div class="highlight highlight-js"><pre><span class="c1">// modules/stats/main.js</span>

<span class="nx">define</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">require</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'jquery'</span><span class="p">),</span>
      <span class="nx">Controller</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>

  <span class="nx">Controller</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">showDetails</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/stats'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;stats&gt;'</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">stats</span> <span class="o">+</span> <span class="s1">'&lt;/stats&gt;'</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">Controller</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>Internal implementation is hidden so developers are not care what's happens inside. Want show stats details? Okay - use showDetails method of Stats component.</p>

<h2>
<a name="benefits" class="anchor" href="#benefits"><span class="octicon octicon-link"></span></a>Benefits</h2>

<h3>
<a name="no-big-scope" class="anchor" href="#no-big-scope"><span class="octicon octicon-link"></span></a>No big scope</h3>

<p>Developers are working with small component scope which reduces complexity of changes even in big application.</p>

<p>No need to keep in mind whole project because developer takes care about internal implementation and Public API. So they <em>feel free to make any changes if Public API stays same</em>.</p>

<p>So even in big project refactoring or new techniques can be implemented without any problems in local component scope.</p>

<h3>
<a name="no-cross-dependencies" class="anchor" href="#no-cross-dependencies"><span class="octicon octicon-link"></span></a>No cross dependencies</h3>

<p>Developers are working with components, not with views / models etc. This reduces complexity of application and allows reuse implemented functionality.</p>

<h1>
<a name="practice" class="anchor" href="#practice"><span class="octicon octicon-link"></span></a>Practice</h1>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Frontend Components-based Architecture maintained by <a href="https://github.com/artyomtrityak">artyomtrityak</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
